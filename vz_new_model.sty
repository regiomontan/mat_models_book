
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%==========================================%%
%%=  В. И. Зенкин Стилевой файл для        =%%
%%=  книги                                 =%%
%%= КУРС МАТЕМАТИЧЕСКОГО И                 =%%
%%= КОМПЬЮТЕРНОГО МОДЕЛИРОВАНИЯ (2014)     =%%
%%==========================================%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

 %%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 %% для генерации PDF-документа, ссылки будут видны только после конвертации
 %% по цепочке dvi -> ps -> pdf
 \newif\ifPDFFLAG   %% флаг для PDF:
 \PDFFLAGtrue       %% взведён
 %\PDFFLAGfalse      %% сброшен
 %%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 \ProvidesPackage{vz_new_model}
 %\usepackage[T2A]{fontenc} %% Заказ шрифтов Лапко-Ходулева
 \usepackage{cmap}                     %% Поддержка поиска русских слов в PDF(pdflatex)
 \usepackage{indentfirst}              %% Красная строка в первом абзаце
% \usepackage{autopagewidth}            %% для шрифтов
% \usepackage{extsizes}                 %% 14-го кегля;
 \usepackage[cp1251]{inputenc}         %% - для WiN;
 \usepackage[english,russian]{babel}   %% Babel;
 \usepackage[T2A]{fontenc}
 %\usepackage{AcademyC}
 \usepackage{pscyr}
 %\usepackage{SclBookC}
 %\usepackage{LiteraturnayaC}          %% Шрифты пакета FontsC:
 %\usepackage{BaskerC}                  %% векторные шрифты,
 %\usepackage{BalticaC}                 %% нужны для нормальных
 %\usepackage{OffSerifC}                %% .pdf и .ps файлов;
 %\usepackage{SclBookC}                 %%
 %\usepackage{AvantC}                   %%
 %\usepackage{PetersburgC}              %%
 %\usepackage[active]{srcltx}           %% функция "Inverse Search";
 \usepackage[dvips]{graphicx}          %%
 \usepackage{wrapfig}                  %% рисунки "в оборку";
 \usepackage{amssymb}                  %% ams-символы;
 \usepackage{amsmath}
 \usepackage{fancyhdr}                 %% колонтитулы;
 %\pagestyle{fancy}
 \usepackage{animate}                  %% анимация;
  %\usepackage{verbatim}
 \usepackage{listings}
 %\usepackage{scalefnt}                 %% масштабирование шрифтов
 \usepackage{wasysym}                   %% промилле
 \usepackage{microtype}                 %% "висячая" пунктуация

%%% подписи под рисунками %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \usepackage[format=hang,               %% втяжка подписи
             labelsep  = period,        %% № и текст разделены точкой и пробелом
             textfont  = sl,
             labelfont = normalfont,
             position  = above,
             skip      = -14pt]
             {caption}

 \frenchspacing
 %\DeclareMathSizes{10}{11  }{8}{7}       %%увеличил мат. шрифты
% \DeclareMathSizes{11}{12  }{8}{7}       %%увеличил мат. шрифты
% \DeclareMathSizes{12}{12.4}{9}{8}       %%увеличил мат. шрифты

 \renewcommand{\rmdefault}{fac}       %%{fac} -academy

 \renewcommand\normalsize{\fontsize{15}{16.0pt}\selectfont}   %%увеличил основной фонт
 \renewcommand\footnotesize{\fontsize{14}{15.0pt}\selectfont} %%увеличил  фонт сносок

 %%================================================================
 %%  Реализация функции Inverse Search для оболочки WinEdt
 %%  Файл Srcltx.sty нужно скопировать в каталог
 %% \localtexmf\tex\latex ( если каталога нет - создать )
 %%================================================================
 %\usepackage[active]{srcltx}
 %%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 \usepackage{color}

% \abovedisplayskip=0.8\abovedisplayskip % отбивки сверху
% \belowdisplayskip=0.8\belowdisplayskip % и снизу формул
% \abovedisplayshortskip=0.8\abovedisplayshortskip  % отбивки сверху
% \belowdisplayshortskip=0.8\belowdisplayshortskip  % и снизу коротких формул
 \frenchspacing
 \DeclareSymbolFont{greek}{U}{psy}{m}{n}  % для греческого
 \DeclareSymbolFontAlphabet{\gr}{greek}   % шрифта

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%%  если нужно собрать книгу в PDF формате со ссылками (ДЛЯ ЧТЕНИЯ С ЭКРАНА)
 %%%%  параметры PDF файла
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

 \ifPDFFLAG
 \definecolor{darkblue}{rgb}{0.10,0.10,0.30}
 \usepackage[ bookmarks,  breaklinks,
              colorlinks, urlcolor = darkblue,
               unicode, pdfstartview=FitH] {hyperref}
 \definecolor{darkgreen}        {rgb} {0.15, 0.25, 0.15}
 \definecolor{commentgreen}     {rgb} {0.1,  0.20, 0.13}
 \definecolor{background_color} {rgb} {1.0,  0.98, 0.9 }
 \hypersetup
 {
 pdftitle    = {Курс математического и компьютерного моделирования},
 pdfauthor   = {В.Зенкин, 2015},
 pdfsubject  = {математические модели компьютерные модели},
 pdfkeywords = {задачи математического моделирования},
 linkcolor   = darkgreen,     %% цвет текста ссылок на мишени внутри документа;
 pagecolor   = darkgreen,     %% цвет текста ссылок на страницу;
 citecolor   = darkgreen,     %% цвет библиографических ссылок (команда \cite);
 }

 \definecolor{darkred}{rgb}{0.59, 0.097, 0.097} %% тёмно-красный

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%%%  если нужно собирать книгу в PDF формате (ДЛЯ ПЕЧАТИ)
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \else
 \usepackage[draft=true]{hyperref} %% выключ. всех гипертекстовых опций;
 \fi
 %%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 \textwidth      = 155mm   %% шиpина текста;
 \textheight     = 250mm   %% высота текста на стpанице;
 \oddsidemargin  = 4.6mm   %% левое поле для нечетной стpаницы;
 \evensidemargin = 4.6mm   %% левое поле для четной стpаницы;
 \topmargin      =-20.4mm  %% веpхнее поле;
 \headheight     = 12mm    %% место для колонтитула;
 \headsep        = 8mm     %% отступ после колонтитула;
 \righthyphenmin = 2       %% можно переносить 2 буквы;
 \tolerance      = 500     %% допустимая пазреженность строки;
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %%% колонтитулы - пакет fancyhdr %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \pagestyle{fancy}
 %% этим мы убеждаемся, что заголовки глав и
 %% разделов используют нижний регистр.
 \renewcommand{\chaptermark}[1]{\markboth{#1}{}}
 \renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}
 \fancyhf{}  %% убираем текущие установки для колонтитулов
 \fancyhead[LE,RO] {\thepage}
 \fancyhead[LO]    {\rightmark}
 \fancyhead[RE]    {\leftmark}
 \renewcommand     {\headrulewidth}{0.5pt}
 \renewcommand     {\footrulewidth}{0pt}
 \addtolength      {\headheight}{0.5pt} %% оставляем место для линейки
 \fancypagestyle   {plain}
   {%
   \fancyhead{} % на обычных страницах убираем колонтитулы
   \renewcommand{\headrulewidth}{0pt}   %% и линейку
   }
 %%%%%%%%% символы  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \newcommand{\YEAR}         {2015}                             %% текущий год
 \newcommand{\const}        {\mathop{\mathrm{const}}\nolimits} %% константа
 \newcommand{\define}       {\mathop{\mathrm{def}}\nolimits}   %% "определяю"
 \newcommand{\txtaccent}[1] {$\acute{\textrm{#1}}$}            %% ударение в тексте
 \newcommand{\divirg}       {\mathop{\mathrm{div}}\nolimits}   %% "div"
 \newcommand{\gradient}     {\mathop{\mathrm{grad}}\nolimits}  %% "grad"
 \newcommand{\delitca}      {\,\vdots\,}                       %% знак "делится"
 \newcommand{\proof}        {\textbf{Доказательство. }}
 \newcommand{\prooff}[1]    {\textbf{Доказательство {#1}. }}
 \newcommand{\proofend}     {$\blacksquare$}
 \newcommand{\HOD}[1]       {{\textup{НОД}}{#1}}
 \newcommand{\rand}         {\mathop{\mathrm{rand}}\nolimits}  %% rand

 %\newcommand{\max}           {\mathop{\mathrm{max}}\nolimits}
 %\newcommand{\ch}           {\mathop{\mathrm{ch}}\nolimits}    %% ch
 %\newcommand{\sgn} {\mathop{\mathrm{sgn}}\nolimits} %% функция signum
 %\newcommand{\PR}  { {\Large$\triangleright$} }     %% начало доказательства
 %\newcommand{\RP}  { {\Large$\triangleleft$} }      %% конец доказательства

 %%%%%%%%% теоремы, леммы... %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \newtheorem{theorem}     {\indent Теорема}    [section]
 \newtheorem{predl}       {\indent}            [section]
 \newtheorem{sledstv}     {\indent Следствие}  [section]
 \renewcommand{\thepredl} {\alph{predl}}
 \newtheorem{opred}       {\indent Определение}[section]
 \newtheorem{lemma}       {\indent Лемма}      [section]
 \newtheorem{primer}      {\indent Пример}     [section]

 %13.10.01 Vyalyi: отбивки вокруг выключных формул меньше стандартных
\abovedisplayskip       3.8pt plus 2.0pt
\belowdisplayskip       3.8pt plus 2.0pt
\abovedisplayshortskip  2.8pt plus 1.2pt
\belowdisplayshortskip  2.8pt plus 1.2pt
\interdisplaylinepenalty=800

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \@addtoreset{footnote}{section}   %% №№ сносок начать заново в каждой секции
 %%%%%%%%% разделы %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \renewcommand{\section}
 {\@startsection{section}
 {1}{.3pt} {-3.5ex plus 1ex minus 1.5ex}   %% оглавление секций
 {1.5ex plus 1.2ex} { \indent \Large\bf }}

 \renewcommand{\thesection}                %% №№ секций
 {\arabic {section}}                       %% не содержат №№ глав

 \renewcommand{\p@section}                 %% для ссылок на формулы, теоремы и т.д.
 {\arabic{section}}                        %% эти №№ НЕ выводить

 \renewcommand{\theequation}               %% №№ формул
 {\arabic {equation}}                      %% не содержат №№ глав

 \renewcommand{\subsection} {%
 \@startsection{subsection}
 {1}{.3pt} {0.1ex plus 0.1ex minus 0.1ex}   %% оглавление подсекций
 {0.1ex plus 0.1ex} {\indent\bfseries\nobreak}}

 \newcommand{\l@addintro}[2]                %% добавление к оглавлению
 {\hbox to\textwidth{#1\dotfill #2}}
 \newcommand{\l@adddefine}[2]               %% добавление к оглавлению
 {\hbox to\textwidth{#1\dotfill #2}}

 %%%%%%% оформление заголовков глав %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \renewcommand{\cleardoublepage}             %% глава может начинаться
 {\clearpage}                                %% с новой страницы
 \renewcommand{\thechapter}{\Roman{chapter}} %% № главы - латинскими цифрами
 \renewcommand{\chapter}
 {\@startsection{chapter}
 {1} {\parindent} {-5.5ex plus -1ex minus .2ex}
 {2.3ex plus .2ex}
 {\LARGE\bf }}

 %%%%%%%% перечни: %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \renewcommand{\@listi}{%
 \leftmargin    = 25pt
 \rightmargin   = 2pt
 \labelsep      = 5pt
 \labelwidth    = 20pt
 \itemindent    = 0pt
 \listparindent = 0pt
 \topsep        = 3pt plus 1pt minus 1pt
 \partopsep     = 0pt plus 1pt minus 1pt
 \parsep        = 0pt plus 1pt
 \itemsep       = \parsep }
 %%%%%%%% задачи: %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \newcounter{task}[chapter] % счётчик для задач
 \newcommand{\z}{\par\refstepcounter{task}%
 {\bf \Roman{chapter}.\arabic{task}.}}
 %% переопределение команды, чтобы в ссылках печатались № секций:
 \renewcommand{\thetask}{\thechapter.\arabic{task}}
 %%%%%%%% вопросы: %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \newcounter{vopros}[chapter] % счётчик для вопроса
 \newcommand{\question}{\par\refstepcounter{vopros}%
 {\bf Вопрос \Roman{chapter}.\arabic{vopros}.}}
 %% переопределение команды, чтобы в ссылках печатались № секций:
 \renewcommand{\thevopros}{\thechapter.\arabic{vopros}}
 %%%%%%%% ответы: %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \newcounter{otvet}[chapter] % счётчик для ответа
 \newcommand{\answer}{\par\refstepcounter{otvet}%
 {\bf Ответ \Roman{chapter}.\arabic{otvet}.}}
 %% переопределение команды, чтобы в ссылках печатались № секций:
 \renewcommand{\theotvet}{\thechapter.\arabic{otvet}}

 %%%%%% подпись под рис., над таблицей %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  \renewcommand{\figurename}{рис.}
%  \renewcommand{\@makecaption}[2]
%  {%
%  \vspace{\abovecaptionskip}      %% расстояние от рис. до подписи
%  \sbox{\@tempboxa}{\it{#1}. #2}  %% "Рис. №.  Подпись..."
%  \ifdim \wd\@tempboxa >\hsize
%     \it{#1}. #2\par
%  \else
%     \global\@minipagefalse
%     \hbox to \hsize {\hfil \it{#1}. #2\hfil }%
%  \fi
%  \vspace{-3mm}       %{\belowcaptionskip}
%  }
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %% Из пакета russcorr.sty С.М.Львовского
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %% С секциями
 %% устроим еще так, чтобы в заголовках после номера ставилась точка.
 %% Например: 4.3. Кое-что о слонах
 %%
 %% Чтобы сохранить возможность возврата к стандарту,
 %% введем команды \aftersectionseparator и т.п. (см. ниже)
 %% и определим их точкой. Чтобы вернуться к сандарту, надо переопределить
 %% их на \relax или {}
 %% Можно определить их и еще как-нибудь, если такое взбредет в голову.
 %%
 %% Заметим, что, если просто сказать что-нибудь наподобие
 %%  \def\thesection{\arabic{chapter}.\arabic{section}.} ,
 %% то возникнут проблемы с \label и \ref .
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \def\@aftersepkern{\kern-.5em}
 \def\postchapter{.}
 \def\postsection{.\@aftersepkern}
 \def\postsubsection{.\@aftersepkern}
 \def\postsubsubsection{.\@aftersepkern}
 \def\postparagraph{.\@aftersepkern}
 \def\postsubparagraph{.\@aftersepkern}
 \def\presection{}
 \def\presubsection{}
 \def\presubsubsection{}
 \def\preparagraph{}
 \def\presubparagraph{}
 %%--------------------------------------------------------------------------
 %%  Приступим к постановке точек после номеров...
 %%--------------------------------------------------------------------------
 \def\@sect#1#2#3#4#5#6[#7]#8{\ifnum #2>\c@secnumdepth
     \let\@svsec\@empty\else
     \refstepcounter{#1}\edef\@svsec{%
     \csname pre#1\endcsname  %% Добавил строку
     \csname the#1\endcsname
     \csname post#1\endcsname %% Добавил строку
 \hskip 1em}\fi
     \@tempskipa #5\relax
      \ifdim \@tempskipa>\z@
        \begingroup #6\relax
          \@hangfrom{\hskip #3\relax\@svsec
                   }{\interlinepenalty \@M \ignorespaces#8\par}%
 %% Вставил в предыдущей строке \ignorespaces
 %% Здесь и далее такие добавки - против лишних пробелов, появляющихся,
 %% если аргумент sectioning-команды начинается с пробела.
         \endgroup
        \csname #1mark\endcsname{\protect\ignorespaces #7}\addcontentsline
 %% Добавил два token'а перед #7
         {toc}{#1}{\ifnum #2>\c@secnumdepth \else
                      \protect\numberline{\csname the#1\endcsname
                     \csname post#1\endcsname %% Добавил строку
 }\fi \protect\ignorespaces #7}\else
 %% Добавил два token'а перед #7
        \def\@svsechd{#6\hskip #3\relax  %% \relax added 2 May 90
                   \@svsec #8\csname #1mark\endcsname
                      {\protect\ignorespaces #7}\addcontentsline
 %% Добавил два token'а перед #7
                           {toc}{#1}{\ifnum #2>\c@secnumdepth \else
                             \protect\numberline{\csname the#1\endcsname
                          \csname post#1\endcsname % Добавил строку
 }\fi \protect\ignorespaces #7}}\fi
 %% Добавил два token'а перед #7
     \@xsect{#5}}
 \def\@ssect#1#2#3#4#5{\@tempskipa #3\relax
   \ifdim \@tempskipa>\z@
     \begingroup #4\@hangfrom{\hskip #1}{\interlinepenalty \@M
 \ignorespaces #5\par}\endgroup %% добавил \ignorespaces перед #5
   \else \def\@svsechd{#4\hskip #1\relax
 \ignorespaces #5}\fi %% добавил \ignorespaces перед #5
    \@xsect{#3}}
 %% После номеров глав тоже пусть стоят точки:
 %
 \def\@makechapterhead#1{%
  \vspace*{50\p@}%
  {\parindent \z@\raggedright
    \ifnum \c@secnumdepth >\m@ne
     \huge\bf \@chapapp{} \thechapter\postchapter %% добавлено \postchapter
    \par
    \vskip 20\p@ \fi
    \Huge \bf
    \ignorespaces #1\par %% добавил \ignorespaces
    \nobreak
    \vskip 40\p@
  }}
 \def\@makeschapterhead#1{%
  \vspace*{50\p@}%
  {\parindent \z@ \raggedright
    \Huge \bf
    \ignorespaces #1\par %% добавил \ignorespaces
    \nobreak
    \vskip 40\p@
  }}
 %%--------------------------------------------------------------------------
 %% Сделаем так, чтоб в оглавлении точки шли и после номеров глав...
 %%--------------------------------------------------------------------------
 \def\@chapter[#1]#2{\ifnum \c@secnumdepth >\m@ne
        \refstepcounter{chapter}%
        \typeout{\@chapapp\space\thechapter.}%
        \addcontentsline{toc}{chapter}{\protect
        \numberline{\thechapter
              \postchapter %% Добавил строку
 }%
 \protect\ignorespaces #1}\else %% Добавил два token'а перед #1
      \addcontentsline{toc}{chapter}{\protect\ignorespaces#1}\fi
 %% В предыдущей строчке вставлено два token'а перед #1
   \chaptermark{\protect\ignorespaces #1}%
   \addtocontents{lof}%
       {\protect\addvspace{10\p@}} %% Adds between-chapter space
   \addtocontents{lot}%
       {\protect\addvspace{10\p@}} %% to lists of figs & tables.
   \if@twocolumn                   %% Tests for two-column mode.
           \@topnewpage[\@makechapterhead{#2}]%
     \else \@makechapterhead{#2}%
           \@afterheading          %% Routine called after chapter and
     \fi}                          %% section heading.

 %%--------------------------------------------------------------------------
 %% Следующая проблема - поставить точки после номеров "теорем".
 %% Мы опять определим \afterthmseparator и инициализируем
 %% его точкой. Для возврата к стандарту - переопределить
 %% его на \relax
 %%--------------------------------------------------------------------------
 %%\message{theorems,}
 \def\afterthmseparator{.}
 \def\@begintheorem#1#2{\trivlist \item[\hskip \labelsep{\bf
 #1\ #2\unskip\afterthmseparator}]\it} %% вставил 2 token'а после #2
 \def\@opargbegintheorem#1#2#3{\trivlist
      \item[\hskip \labelsep{\bf
 #1\ #2\ (#3)\afterthmseparator}]\it} %% вставил token после (#3)
 %%--------------------------------------------------------------------------
 %% Подправим еще одну feature: \cleardoublepage выдает на
 %% пустой странице колонтитул, оставшийся от предыдущего раздела.
 %% Сделаем так, чтобы этого не было...
 %%--------------------------------------------------------------------------
 %%\message{\string\output,}
 %%\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
 %%  {\null\ps@empty % добавил \ps@empty (и заодно заменил \hbox{} на \null )
 %%\newpage}\if@twocolumn\hbox{}\newpage\fi\fi\fi}

 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% настройки листингов пакет listings %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% настройки листингов пакет listings %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \lstset
 {
 linewidth=0.99\textwidth,       %% ширина листинга;
 xleftmargin= 3pt,               %% отступ слева;
 frameround=tttt,                %% рамка с закруглениями
 frame=trbl,                     %% вокруг листингов;
 language=Delphi,
 %%basicstyle=\texttt,           %%\small,
 keywordstyle=\textsl,           %% ключевые слова;
 %%tabsize=2,
 extendedchars=true,             %% русский шрифт;
 %basewidth={0.45em,0.45em},      %% подстройка ширины;
 columns=flexible,
 stringstyle=\rmfamily\texttt\tiny\color{darkblue},
 showstringspaces=false,
 commentstyle=\color{commentgreen},
 alsoletter={. , ;}
 }

\lstdefinelanguage{Maxima}
{
 keywords={addrow,addcol,zeromatrix,ident,augcoefmatrix,ratsubst,diff,ev,tex,%
    with_stdout,nouns,express,depends,load,submatrix,div,grad,curl,%
    rootscontract,solve,part,assume,sqrt,integrate,abs,inf,exp,if,block},
 sensitive=false,
 morecomment=[s]{/*}{*/},
}

%% Language definition of Yacc/Bison for listings package

%% Yacc
\lstdefinelanguage[]{Yacc}%
  {otherkeywords=%
    {\%left,
      \%nonassoc,\%prec,\%right,
      \%start,\%token,\%type,\%union,
      \%\%,\%\{,\%\},|,:,
      \$\$,\$1,\$2,\$3,\$4,\$5,\$6,\$7,\$8,\$9
    },%
    keywords={\%seeREADME},%
    morecomment=[n]{/*}{*/},%
    morestring=[b]{"},%
    sensitive=true
  }[keywords,comments,strings]%


%% Yacc: Bison

%% Listings does not support ``moreotherkeywords'', so we cannot
%% simply inherit.  To bad for code duplication.
\lstdefinelanguage[Bison]{Yacc}%
  {otherkeywords=%
    {\%binary,\%debug,\%default-prec,\%define,\%defines,\%destructor,
      \%dprec,\%error-verbose,\%expect,\%expect-rr,\%file-prefix,
      \%fixed-output-files,\%initial-action,\%glr-parser,
      \%language,\%left,
      \%lex-param,\%locations,\%merge,\%name-prefix,\%no-default-prec,
      \%no-lines,\%nonassoc,\%nondeterministic-parser,\%nterm,\%output,
      \%parse-param,\%prec,\%printer,\%pure-parser,\%right,\%skeleton,
      \%start,\%term,\%token,\%token-table,\%type,\%union,\%verbose,\%yacc,
      \%\%,\%\{,\%\},|,:,
      \$\$,\$1,\$2,\$3,\$4,\$5,\$6,\$7,\$8,\$9,
      @\$,@1,@2,@3,@4,@5,@6,@7,@8,@9
    },%
    keywords={\%seeREADME},%
    morecomment=[n]{/*}{*/},%
    morecomment=[s]{//},%
    morestring=[b]{"},%
    sensitive=true
  }[keywords,comments,strings]%

\lstdefinelanguage{Bison}[Bison]{Yacc}{}

%% висячая пунктуация %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\SetProtrusion
{
}
{
«  = {1000,     },
»  = {    , 1000},
„  = {1000,     },
“  = {    , 1000},
(  = {1000,     },
)  = {    , 1000},
!  = {    , 1000},
?  = {    , 1000},
:  = {    , 1000},
;  = {    , 1000},
.  = {    , 1000},
-  = {    ,  500},
{,}= {    , 1000}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
