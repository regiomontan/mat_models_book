\newif\ifflagNOBOOK   %% флаг "не собирать книгу":
 %\flagNOBOOKtrue       %% взведён
 \flagNOBOOKfalse      %% сброшен

 \ifflagNOBOOK
 \documentclass[12pt,a4paper]{book}
 \usepackage{vz}
 \begin{document}
 \thispagestyle{empty}
 {\Large\bf{Приложение. Решение дифференциальных уравнений}}
 \fi

 Традиционно многие математические модели описываются \emph{дифференциальными уравнениями} "---
 соотношениями, связывающими независимую переменную, неизвестную функцию этой переменной
 и ее производные или дифференциалы до некоторого порядка включительно.
 Порядок наивысшей производной, входящей в дифференциальные уравнения, называется \emph{порядком}
 этого дифференциального уравнения.
 \emph{Решением} (\emph{интегралом}) дифференциального уравнения называется функция, удовлетворяющая
 этому уравнению.

 Следует специально отметить, что в теории дифференциальных уравнений под решением понимается
 не только явный вид
 неизвестной функции, но и её выражение \emph{в квадратурах} "---  в виде интеграла от комбинации
 известных (<<элементарных>>, <<стандартных>>) функций, который не обязательно выражается в
 элементарных функциях. Например, уравнение
 $$%---------------------------------------------------------------------
    x y^\prime = e^x,
 $$%---------------------------------------------------------------------
 имеет решение в квадратурах
 $$%---------------------------------------------------------------------
    y  = \int \frac{e^x}{x}\,\mathrm{d} x + C,
 $$%---------------------------------------------------------------------
 где $C$ "--- константа, а интеграл в правой части равенства не выражается через элементарные
 функции (<<неберущийся>> интеграл).

 Такое решение, очевидно, не годится для целей математического моделирования, так как модель,
 как правило, должна описываться конкретными \emph{числовыми} величинами. В таких случаях
 лучше применить численные методы решения.

 Вообще, при математическом моделировании более-менее сложных объектов аналитическое
 решение соответствующих дифференциальных уравнений "--- скорее исключение, а не правило.
 Тем не менее, наличие общего решения дифференциального уравнения в замкнутом виде
 во многих случаях даёт значительные преимущества по сравнению с численными решениями.
 Перечислим некоторые случаи, когда аналитическое решение обыкновенных дифференциальных
 уравнений возможно, детально известные решения перечислены в справочниках \cite{KAMKE},
  \cite{ZAYCEV}.

 \subsection{Уравнения с разделяющимися переменными}
 \vspace{-2.5ex}
  %---------------------------------------------------------------------
  \begin{equation} \label{diff_split}
    a(x)b(y) \mathrm{d}x + c(x)d(y) \mathrm{d}y = 0.
  \end{equation}
 %---------------------------------------------------------------------
 После почленного деления на $b(y)c(x)$ получим
 $$%---------------------------------------------------------------------
    \frac{a(x)}{c(x)}\,\mathrm{d}x + \frac{d(y)}{b(y)}\,\mathrm{d}y = 0,
 $$%---------------------------------------------------------------------
 разделение переменных: коэффицент при $dx$ зависит только от $x$, а коэффицент при
 $dy$ "--- только от $y$. Решение находится из соотношения
 $$%---------------------------------------------------------------------
    \int \frac{a(x)}{c(x)}\,\mathrm{d}x + \int \frac{d(y)}{b(y)}\,\mathrm{d}y = 0,
 $$%---------------------------------------------------------------------
  и, кроме того, нужно учесть решения уравнения
 $$%---------------------------------------------------------------------
    b(y)c(x) = 0,
 $$%---------------------------------------------------------------------
  которые могли быть <<потеряны>> при решении \eqref{diff_split}.

 \subsection{Однородные дифференциальные уравнения}
 \vspace{-2.5ex}
 %---------------------------------------------------------------------
  \begin{equation} \label{diff_homogeneous}
    a(x,y) \mathrm{d}x + b(x,y) \mathrm{d}y = 0,
  \end{equation}
 %---------------------------------------------------------------------
 где функции $a(x,y)$, $b(x,y)$ "--- однородные, степени $k$, то есть
 удовлетворяют тождеству
 $$%---------------------------------------------------------------------
    f(\lambda x, \lambda y ) = \lambda^k f(x,y).
 $$%---------------------------------------------------------------------

 Подстановка $y = tx$ сводит однородное уравнение к уравнению с разделяющимися
 переменными.

 \subsection{Линейные дифференциальные уравнения первого порядка}
 \vspace{-2.5ex}
 %---------------------------------------------------------------------
  \begin{equation} \label{diff_linear1}
    y' + p(x) y = q(x)
  \end{equation}
 %---------------------------------------------------------------------
 имеют решение
 $$%---------------------------------------------------------------------
   y = e^{-\int\!p(x)\,\mathrm{d}x} \left(\int\!q(x) e^{\int\!p(x)\,\mathrm{d}x} \mathrm{d}x + C \right)
 $$%---------------------------------------------------------------------

 \subsection{Линейные однородные уравнения с постоянными коэффициентами
             $\mathbf{n}$-го порядка}
  Здесь под однородностью уравнения понимается отсутствие  свободного члена "--- слагаемого,
  не зависящего от неизвестной функции:
 %---------------------------------------------------------------------
  \begin{equation} \label{diff_linear_const_homogeneous}
    y^{(n)} + a_1 y^{(n - 1)} + \ldots a_{n-1}y' + a_n y = 0,
  \end{equation}
 %---------------------------------------------------------------------
 где $a_1, \ldots ,a_n$ "--- вещественные константы. Решение уравнения
 \eqref{diff_linear_const_homogeneous}
 связано с решениями \emph{характеристического уравнения}
 $$%---------------------------------------------------------------------
   \lambda^{n} + a_1 \lambda^{n - 1} + \ldots + a_{n-1}\lambda + a_n = 0,
 $$%---------------------------------------------------------------------
 имеющего вследствие основной теоремы алгебры ровно $n$ корней, среди которых
 могут быть и комплексные, которые в этом случае входят в множество решений парами
 комплексно сопряженных чисел\footnote{Так как коэффициенты характеристического уравнения
                            действительны.}.
 Общее решение \eqref{diff_linear_const_homogeneous} является суммой, слагаемые которой
 определяются типом корней характеристического уравнения, а именно:
 \begin{itemize}
   \item каждому действительному простому корню $\lambda$ в общем решении соответствует
         слагаемое $Ce^{\lambda x}$, где $C$ "--- константа;
   \item каждому вещественному корню $\lambda$ кратности $k$ в общем решении соответствует
         слагаемое $(C_1 + C_2x + \ldots + C_k x^{k-1}) e^{\lambda x}$,
         $C_i$ "--- константы;
   \item каждой паре комплексных сопряженных простых корней
         $$%---------------------------------------------
           \alpha \pm \beta i
         $$%---------------------------------------------
         в общем решении соответствует слагаемое вида
         $$%---------------------------------------------
            e^{\alpha x} (C_1 \cos\beta x + C_2\sin\beta x);
         $$%---------------------------------------------
   \item каждой паре комплексно сопряженных корней кратности $k$ соответствует
         слагаемое
         %-----------------------------------------------------------------------
         \begin{multline}
          e^{\alpha x} \Big(\!\left(A_1 + A_2 x + \ldots + A_{k-1} x^{k-1} \right) \cos\beta x + \\
           + \left(B_1 + B_2 x + \ldots + B_{k-1} x^{k-1}\right) \sin\beta x \Big),
         \end{multline}
         %--------------------------------------------------------------------
         где $A_i, B_i$ "--- константы.
 \end{itemize}

 \subsection{Неоднородные линейные уравнения}\label{section_diff_lin_nonhomogen}
 \vspace{-2.5ex}
 %---------------------------------------------------------------------
  \begin{equation} \label{diff_linear_nonhomogen}
    y^{(n)} + a_1(x) y^{(n - 1)} + \ldots a_{n-1}(x)y' + a_n(x) y = f(x).
  \end{equation}
 %---------------------------------------------------------------------
 Общее решение неоднородного линейного уравнения равно сумме \emph{любого}
 его частного решения и общего решения соответствующего однородного уравнения. Частные
 решения в некоторых случаях можно найти подбором, а в общем случае "---
 \emph{методом вариации постоянных} Лагранжа: в общем решении однородного уравнения, соответствующего
 \eqref{diff_linear_nonhomogen}
 %----------------------------------------------------------------------
 \begin{equation} \label{diff_linear_homogen_solvee}
    C_1 y_1 + \ldots + C_n y_n,
 \end{equation}
 %----------------------------------------------------------------------
 константы интегрирования $C_1, \ldots, C_n$ считают неизвестными функциями от $x$, которые
 определяют
 подставив \eqref{diff_linear_homogen_solvee} в уравнение \eqref{diff_linear_nonhomogen}.
 Например, для уравнения с постоянными коэффициентами
 $$%---------------------------------------------
   y'' + a_1y' + a_2y = f(x)
 $$%---------------------------------------------
 функции $C_1(x), C_2(x)$ подбираются так, чтобы они удовлетворяли соотношениям
 %---------------------------------------------------------------------
  \begin{eqnarray*}
    C_1'(x) y_1 + C_2'(x) y_2   &=&\!\!0, \\
    C_1'(x) y_1' + C_2'(x) y_2' &=&\!\!f(x).
  \end{eqnarray*}
 %---------------------------------------------------------------------

\subsection{Устойчивость решений} \label{app_stability}
Если не известно аналитическое решение дифференциального уравнения, численные решения
получают последовательно задавая значения входных параметров "--- начальных или
краевых условий, констант и т.\,д. Однако часто бывают нужны данные о поведении модели при
\emph{всех} входных параметрах. В частности, не редко возникает потребность в информации
об \emph{устойчивости} решений в окрестности некоторой точки или области фазового пространства.
Под устойчивостью понимается свойство решений \emph{не сильно} отклоняться друг от друга при
\emph{малом} изменении входных параметров. Например, по отношению к механическим системам это
означает, что \emph{малые} воздействия на систему не выведут её из равновесия.

Придание точного смысла понятиям, обусловливающим устойчивость, "--- <<не сильно>>, <<мало>>
и~т.\,п. "--- приводят  к различным её определениям: устойчивость по Ляпунову,
асимптотическая устойчивость, эквиасимптотическая устойчивость и т.д. \cite{MALKIN},
\cite{CHETAEV_ust}.

Пусть для системы дифференциальных уравнений
%%----------------------------------------------------------
\begin{equation} \label{app_stability_1}
 \mathbf{\dot{x}} = \mathbf{f}(t, \mathbf{x})
 \qquad \mathbf{x}(t_0) = \mathbf{x_0}
\end{equation}
%%----------------------------------------------------------
справедливы условия существования и единственности на множестве $(t, \mathbf{x})$, где
$\alpha < t < +\infty$, $\mathbf{x} \in C$, $C$ "--- открытое множество в пространстве
переменного $\mathbf{x}$.


{\opred Решение $\mathbf{x} = \boldsymbol{\gr{j}}(t)$ ($t \geqslant t_0$)
системы~\eqref{app_stability_1} называют \textsl{устойчивым по Ляпунову}, если для
любого $\varepsilon > 0$ найдется такое $\delta > 0$, что для любого вектора  $\mathbf{x_0}$
с условием
$$
 |\boldsymbol{\gr{j}}(t_0) - \mathbf{x_0}| < \delta,
$$
решение $\mathbf{x} = \boldsymbol{\gr{y}}(t)$ с начальным условием
$\boldsymbol{\gr{y}}(t_0) = \mathbf{x_0}$ определено при всех $t \geqslant t_0$ и выполняется
$$
 |\boldsymbol{\gr{j}}(t) - \boldsymbol{\gr{y}}(t)| < \varepsilon, \qquad t \geqslant t_0.
$$

Если, сверх того,
$$
\lim_{t \rightarrow +\infty} |\boldsymbol{\gr{j}}(t) - \boldsymbol{\gr{y}}(t)| = 0,
$$
то решение $\mathbf{x} = \boldsymbol{\gr{j}}(t)$ называют
\textsl{асимптотически устойчивым.}
}

Легко видеть, что исследование устойчивости решения $\mathbf{x} = \boldsymbol{\gr{j}}(t)$
системы \eqref{app_stability_1} равносильно проверке устойчивости решения, тождественно
равного нулю. Действительно, положим
$$
 \mathbf{y} = \mathbf{x} - \boldsymbol{\gr{j}}(t),
$$
тогда устойчивость $\mathbf{x} = \boldsymbol{\gr{j}}(t)$ эквивалентна устойчивости
решения $\mathbf{y} = \boldsymbol{0}$.

\subsubsection{Устойчивость решений линейной системы с постоянными коэффициентами} \label{app_stability_sub_1}
\vspace{-3.4ex}
\begin{equation} \label{app_stability_1_1}
 \mathbf{\dot{x}} = \mathbf{A x},
\end{equation}
где $\mathbf{A}$ "--- постоянная действительная матрица.

Для того, чтобы положение равновесия $\mathbf{y} = \boldsymbol{0}$ системы
\eqref{app_stability_1_1} было
\begin{description}
  \item[\normalfont{\textsl{---~асимптотически устойчиво,}}] необходимо и достаточно, чтобы все
        собственные значения матрицы
       $\mathbf{A}$ имели \emph{отрицательные действительные части;}
  \item[\normalfont{\textsl{---~устойчиво по Ляпунову,}}] необходимо (но не достаточно), чтобы
        все собственные значения матрицы $\mathbf{A}$ имели \emph{неположительные действительные части;}
\end{description}

\subsubsection{Устойчивость решений системы в первом приближении} \label{app_stability_sub_2}
\vspace{-3.4ex}
\begin{equation} \label{app_stability_1_2}
 \mathbf{\dot{x}} = \mathbf{f}(t, \mathbf{x}).
\end{equation}

Пусть правая часть \eqref{app_stability_1_2} удовлетворяет условиям существования и единственности
решения и имеет вид
$$
  \mathbf{f}(t, \mathbf{x}) = \mathbf{A}(t)\mathbf{x} + \mathbf{F}(t, \mathbf{x})
$$
с условием
$$
 \lim_{|\mathbf{x}| \, \rightarrow \, 0} \frac{|\mathbf{F}(t, \mathbf{x})|}{|\mathbf{x}|} = 0.
$$

{\opred Линейную однородную систему
$$
  \mathbf{\dot{x}} = \mathbf{A}(t)\mathbf{x}, \qquad
  \mathbf{A}(t) = \left[ \frac{\partial f_i}{\partial x_j} (t,0) \right]
$$
называют \textsl{первым приближением} (\textsl{линеаризацией}) системы \eqref{app_stability_1_2}.
}

В частности, для случая, когда матрица $\mathbf{A}$ постоянна, вопрос об устойчивости решения
системы
\begin{equation} \label{app_stability_1_2_const}
 \mathbf{\dot{x}} = \mathbf{A} \mathbf{x} + \mathbf{F}(t, \mathbf{x}), \qquad
 \mathbf{F}(t, \mathbf{0}) = \mathbf{0}
\end{equation}
определяется теоремами Ляпунова:
\begin{itemize}
  \item Если все собственные значения матрицы $\mathbf{A}$ имеют \emph{отрицательные
        действительные части} и
        $$
          \left| \mathbf{F}(t, \mathbf{x}) \right| \leqslant M |\mathbf{x}|^{1 + \alpha}
        $$
        при $t \geqslant t_0$, достаточно малом $|\mathbf{x}|$ и некоторых положительных
        константах $\alpha$, $M$, то положение равновесия $\mathbf{x} = \mathbf{0}$ системы
        \eqref{app_stability_1_2_const} \textsl{асимптотически устойчиво.}
  \item Если среди собственных значений матрицы $\mathbf{A}$ есть \emph{хотя бы одно с
        положительной действительной частью} и
        $$
          \left| \mathbf{F}(t, \mathbf{x}) \right| \leqslant M |\mathbf{x}|^{1 + \alpha}
        $$
        при $t \geqslant t_0$, достаточно малом $|\mathbf{x}|$ и некоторых положительных
        константах $\alpha$, $M$, то положение равновесия $\mathbf{x} = \mathbf{0}$ системы
        \eqref{app_stability_1_2_const} \textsl{неустойчиво.}
\end{itemize}

{\opred Говорят, что \textsl{система находится на границе устойчивости,} если хотя бы одно
собственное значение матрицы $\mathbf{A}$  имеет нулевую действительную часть, а
действительные части всех остальных собственных значений отрицательны.}

При исследовании устойчивости по первому приближению необходимо определить знаки действительных
частей собственных значений матрицы, т.\,е. корни характеристического многочлена. Эта задача
может быть решена применением \textsl{критерия Рауса "--- Гурвица} \cite{CHETAEV_ust}. В частности,
для характеристических многочленов второй и третьей степеней
\begin{gather*} \label{Gurvitz_criterion}
 \lambda^2 + a_1 \lambda + a_2, \\
 \lambda^3 + b_1 \lambda^2 + b_2 \lambda + b_3
\end{gather*}
этот критерий формулируется так: все корни имеют отрицательные действительные части, тогда и
только тогда, когда, соответственно, выполняются соотношения
\begin{gather*}
 a_1 > 0, \quad a_2 > 0, \\
 b_1 > 0, \quad b_1 b_2 - b_3 > 0, \quad b_3 > 0.
\end{gather*}
Если в последнем условии вместо $b_3 > 0$ будет $b_3 = 0$, то система находится на
границе устойчивости.

Необходимым (но не достаточным, для степеней многочлена больших $2$) условием устойчивости
системы является положительность всех
коэффициентов характеристического многочлена. Таким образом, если у характеристического полинома
есть хотя бы один отрицательный коэффициент, то решение неустойчиво.

\subsection{Численное решение дифференциальных уравнений} \label{app_diff_numeric}

Аналитические решения дифференциальных уравнений удается получить только для
относительно простых случаев. Поэтому с появлением быстродействующих коппьютеров
численные методы решения стали одним из основных способов
решения конкретных практических задач для обыкновенных дифференциальных уравнений.

Рассмотрим численные методы решения \emph{задачи Коши}
%-------------------------------------------------------------------------------
\begin{equation} \label{Couchi_task}
  y^\prime = f(x, y), \quad y(x_0) = y_0.
\end{equation}
%-------------------------------------------------------------------------------

Далее предполагается, что численные методы применяются к задаче Коши, имеющей
единственное решение и, сверх того, это решение должно быть устойчивым по
начальным данным, т.\,е. \emph{малые изменения начальных условий приводят к достаточно малому
изменению интегральных кривых} \cite{KARTASHEV}.

Считая, что решение задачи \eqref{Couchi_task} существует и единственно,
требуется на некотором отрезке $[x_0, x_n]$ найти её приближенное
решение с заданной точностью $\varepsilon$ (погрешностью):
$$
  \widehat{y}_i \approx y(x_i), \qquad x_i = x_0 + ih, \quad i = 0, 1, \ldots, n,
$$
где константа $h$ называется \emph{шагом} интегрирования, последовательность
$\Omega = \{x_0, x_1, \ldots, x_n\}$ называют равномерной (регулярной) \emph{сеткой.}

%+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 \begin{figure}[h]
 \begin{center}
 \includegraphics[height = 0.23\textheight, width = 0.80\textwidth]
  {pict/diff_setka.pdf}
  %\vspace{.6\abovecaptionskip}
  \caption{Регулярная сетка}
  \label{diff_setka_pdf}
  \end{center}
 \end{figure}
 %+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\emph{Локальной ошибкой} численного метода на $i$-м шаге называется
величина $\varepsilon_i = |\widehat{y}_i - y(x_i)|$. Погрешность
определяется формулой
$$
 \varepsilon = \varepsilon(h) = \max_{i \, = \, 0, 1, \ldots, n} \varepsilon_i
$$

{\opred Число $p$ называют \emph{порядком} (\emph{точностью}) метода, если
$$
  \varepsilon = O(h^p).
$$}

Существует два типа схем решения дифференциальных уравнений:
\begin{description}
  \item[ { } Явные,] когда для определения $\widehat{y}_i$ могут использоваться лишь значения
                вычислений на предыдущих шагах, т.\,е.
                $$
                  \widehat{y}_i = \Phi(x_0, x_1, \ldots, x_{i-1 }, \widehat{y}_0,
                      \widehat{y}_1, \ldots, \widehat{y}_{i-1} );
                $$
  \item[ { } Неявные,] когда искомая величина $\widehat{y}_i$ входит одновременно и в левую, и в
                 правую часть итерационного соотношения
                $$
                  \widehat{y}_i = \Phi(x_0, x_1, \ldots, x_{i}, \widehat{y}_0,
                      \widehat{y}_1, \ldots, \widehat{y}_{i-1}, \widehat{y}_{i} );
                $$
\end{description}
Явные схемы проще, но зачастую неявные схемы предпочтительнее.

\subsubsection{Метод Эйлера (метод ломаных)}

\noindent Если заменить в \eqref{Couchi_task} производную её разностным приближением
$$
   y' \approx \frac{y(x+h) - y(x)}{h} = \frac{y_{i+1} - y_i}{h},
$$
то получим приближенное
равенство\footnote{Здесь и далее \emph{приближенные} значения $\widehat{y}_i$ будем писать
                   просто: $y_i$. }
%---------------------------------------------------------------------------------
 \begin{equation} \label{shema_Euler}
  y_{i+1} = y_i + h f(x_i, y_i), \qquad i = 0, 1, 2, \dots, n.
 \end{equation}
%---------------------------------------------------------------------------------

Данная процедура называется \emph{методом Эйлера}, она имеет пеpвый порядок точности
по $h$, если $f(x,y)$ ограничена вместе со своими первыми производными по обоим
аргументам \cite{SAMARSKY_VVED_CHISL}, \cite{BACHVALOV},
$$
 \varepsilon = \max_{i = 0, 1, \dots, n} \left|y_i - y( x_i ) \right| = O(h).
$$

Метод Эйлера очень прост в программной реализации, но
вследствие своих недостатков:
\begin{itemize}
  \item малой точности;
  \item накопления ошибок "---
        погрешность на каждом новом шаге систематически возрастает,
\end{itemize}
для практического нахождения решений задачи Коши в настоящее время применяется редко.

Геометрический смысл схемы \eqref{shema_Euler} заключается в приближении решения
на отрезке $[x_i, x_{i+1}]$ отрезком касательной в точке $x_i$:
если соединить точки $(x_i, y_i)$ прямолинейными отрезками, получим \emph{ломаную Эйлера}, каждое
звено которой с началом в точке $(x_i, y_i)$ имеет угловой коэффициент, равный $f(x_i, y_i)$.
Фактически, на каждом шаге метода из-за погрешности приближенное решение переходит с
одной интегральной кривой на другую и поэтому ломаная, как правило, сильно отклоняется от
точного решения.

Точность метода Эйлера можно повысить, улучшив
аппроксимацию функции $y(x)$, если при её разложении
в ряд Тейлора учесть дополнительно слагаемое, содержащее $h^2$.

Подставляя аппроксимацию второй производой ее конечной разностью
$$
  y'' \approx \frac{y'(x_{i+1}) - y'(x_{i})}{h}
$$
в формулу Тейлора и отбрасывая члены ряда, начиная со слагаемого, содержащего $h^3$,
запишем
$$
 y(x_{i+1}) = y(x_{i}) + \frac{h}{2} \big( y'(x_{i}) + y'(x_{i+1}) \big),
$$
откуда, после замены производных правыми частями по формуле \eqref{Couchi_task},
получим расчетную формулу \emph{метода Эйлера с уточнением}
%---------------------------------------------------------------------------------
 \begin{equation} \label{shema_Euler_ne}
  y_{i+1} = y_i + \frac{h}{2} \big( f(x_{i}, y_i) + f(x_{i+1}, y_{i+1}) \big),
  \qquad i = 0, 1, 2, \dots, n.
 \end{equation}
%---------------------------------------------------------------------------------
Схема \eqref{shema_Euler_ne} "--- неявная, поскольку $y_{i+1}$
присутствует одновременно в левой и правой её частях.

Поскольку неизвестная величина $y_{i+1}$ в схеме \eqref{shema_Euler_ne} входит как
аргумент в функцию $f$, для вычисления по неявной схеме, вообще говоря, придется разрешить
уравнение \eqref{shema_Euler_ne} относительно  $y_{i+1}$, что составляет дополнительную
проблему.

Схему \eqref{shema_Euler_ne} можно превратить в явную, если дополнить ее, подставляя в
правую часть  \eqref{shema_Euler_ne} значение $y_{i+1}$, предварительно рассчитав его
 по формуле~\eqref{shema_Euler}:
%---------------------------------------------------------------------------------
 \begin{eqnarray} \label{shema_Euler_pred_corr}
  y_{i+1}^{(k)} &=& y_i + \frac{h}{2} \Big( f(x_{i}, y_i) + f\left(x_{i+1}, y_{i+1}^{(k-1)}\right) \Big), \\
  y_{i+1}^{(0)} &=& y_i + h f(x_i, y_i).
 \end{eqnarray}
%---------------------------------------------------------------------------------

 При этом предварительно вычисленное значение $y_{i+1}$
 называют \emph{прогнозом,} а уточнение результата по формуле \eqref{shema_Euler_ne} "---
 его \emph{коррекцией.}
 Семейство численных алгоритмов, использующих методы прогноза и коррекции, называют схемами \emph{предиктор-корректор}
 (англ. predictor "--- предсказатель, corrector "--- исправляющий).

 Модифицированный метод Эйлера обеспечивает второй порядок точности. Повышение точности
 алгоритма достигается, однако, за счет дополнительных итераций при расчетах на каждом шаге.

 \subsubsection{Метод Рунге "--- Кутты}

 \noindentНаиболее широко применяется метод Рунге "--- Кутты четвертого порядка "---
так называемый \emph{стандартный} или \emph{классический} метод Рунге "---  Кутты:
\begin{align} \label{runge_kutta_4}
 & y_{i+1} = y_i + \frac{1}{6}\,\big( k_1 + 2 k_2 + 2 k_3 + k_4 \big), \\
 & k_1 = h f(x_i, y_i), \nonumber \\
 & k_2 = h f\left(x_i + \frac{h}{2}, y_i + \frac{k_1}{2} \right),  \\
 & k_3 = h f\left(x_i + \frac{h}{2}, y_i + \frac{k_2}{2} \right), \nonumber \\
 & k_4 = h f\big(x_i + h, y_i + k_3 \big), \nonumber
\end{align}

Этот метод имеет четвёртый порядок точности, то есть суммарная ошибка на всем
интервале интегрирования имеет порядок $O(h^4)$ (ошибка на каждом шаге "--- $O(h^5)$).

Схемы Рунге "--- Кутты, выше четвертого порядка точности, как правило,
оказываются громоздкими и неудобными для практического применения и,
потому,  используются редко.

Схемы Рунге-Кутта естественным образом обобщаются на случай систем уравнений
 первогого порядка при
помощи формальной замены функций $y(x)$ и $f(x; y)$ на вектор-функции
$\mathbf{y}(x)$ и $\mathbf{f}(x; \mathbf{y})$
$$
  \mathbf{y'} = \mathbf{f}(x; \mathbf{y}), \qquad \mathbf{y}(0) = \mathbf{y_0},
$$
 а поскольку, как известно, любое
 дифференциальное уравнение $n$-го порядка эквивалентно системе из $n$ уравнений
 первого порядка, то методы Рунге "--- Кутты можно применять для уравнений
 любого порядка.

 Например, для системы двух дифференциальных уравнений, обозначив
 $\mathbf{y} = (y(x), z(x))^\textrm{T}$, $\mathbf{f} = (f(x), g(x))^\textrm{T}$ и, соответственно,
  $\mathbf{y_i} = (y_i, z_i)^\textrm{T}$, $\mathbf{k_m} = (k_m, q_m)^\textrm{T}$,
  метод Рунге "--- Кутты 4-го порядка принимает вид
$$
 \mathbf{y_{i+1}} = \begin{pmatrix}
                      y_{i+1} \\
                      z_{i+1}
                    \end{pmatrix}
                    =
                    \begin{pmatrix}
                      y_i + \big( k_1 + 2 k_2 + 2 k_3 + k_4 \big) / 6 \\
                      z_i + \big( q_1 + 2 q_2 + 2 q_3 + q_4 \big) / 6
                    \end{pmatrix},
$$
\begin{align*}
  & k_1 = h f(x_i, y_i), \quad q_1 = h g(x_i, y_i), \\
  & k_2 = h f\left(x_i + \frac{h}{2}, y_i + \frac{k_1}{2}, z_i + \frac{q_1}{2} \right),  \\
  & q_2 = h g\left(x_i + \frac{h}{2}, y_i + \frac{k_1}{2}, z_i + \frac{q_1}{2} \right),
\end{align*}

\begin{align*}
  & k_3 = h f\left(x_i + \frac{h}{2}, y_i + \frac{k_2}{2}, z_i + \frac{q_2}{2} \right),  \\
  & q_3 = h g\left(x_i + \frac{h}{2}, y_i + \frac{k_2}{2}, z_i + \frac{q_2}{2} \right), \\
  & k_4 = h f\big(x_i + h, y_i + k_3, z_i + q_3 \big),  \\
  & q_4 = h g\big(x_i + h, y_i + k_3, z_i + q_3 \big).
\end{align*}

Таким же образом расчетные формулы метода Рунге "--- Кутты обобщаются на случай системы из
трех и более уравнений.

\subsubsection{Правило Рунге}

\noindent При численном решении задач Коши \eqref{Couchi_task}
обычно требуется найти их приближенное решение с некоторой заданной
точностью~$\varepsilon$, которая определяется условиями решаемой прикладной задачи.
 Для формул Рунге "--- Кутты
такая погрешность пропорциональна величине выбираемого шага $h$ \cite{BACHVALOV}.
Способ выбора такой величины шага интегрирования, чтобы обеспечивалась требуемая
точность численного решения, дает правило Рунге.

\emph{Основная проблема состоит в том,
что при численном решении обычно точное решение задачи не известно.}

Функцию ошибки $\varphi_r(h)$ по формуле Тейлора можно представить в виде
$$
  \varphi_r(h) = \frac{\varphi^{(s+1)}_r(0)}{(s + 1)!}\, h^{s+1} +
                \frac{\varphi^{(s+2)}_r(h)(\xi h)}{(s + 2)!}\, h^{s+2},
  \qquad 0 < \xi < 1.
$$
Следовательно, если обозначить $y(x)$ "--- точное решение задачи \eqref{Couchi_task} на
отрезке $[x, x + h]$, а  $\tilde{y}_{(h)}$ "--- приближенное решение, получаемое по соответствующей
формуле Рунге "--- Кутты с шагом $h$, то
$$
 \tilde{y}_{(h)}(x + h) - y(x + h) \approx \frac{\varphi^{(s+1)}_r(0)}{(s + 1)!}\, h^{s+1}
$$

\noindent и, в силу малости $h$, погрешность на следующем шаге интегрирования будет иметь тот же главный
член, то есть  \emph{после двух шагов} получим
%------------------------------------------------------------------------------------------
\begin{equation} \label{Runge_rule_1}
 \tilde{y}_{(h)}(x + 2h) - y(x + 2h) \approx 2\,\frac{\varphi^{(s+1)}_r(0)}{(s + 1)!}\, h^{s+1}.
\end{equation}
%------------------------------------------------------------------------------------------

С другой стороны, если применить все ту же формулу Рунге "--- Кутты, но с
удвоенным  шагом $2h$, то
%------------------------------------------------------------------------------------------
\begin{equation} \label{Runge_rule_2}
 \tilde{y}_{(2h)}(x + 2h) - y(x + 2h) \approx \frac{\varphi^{(s+1)}_r(0)}{(s + 1)!}\,(2 h)^{s+1}.
\end{equation}
%------------------------------------------------------------------------------------------

Из соотношений \eqref{Runge_rule_1} и \eqref{Runge_rule_2} следует
$$
 \tilde{y}_{(h)}(x + 2h) - y(x + 2h) \approx
 \frac{\tilde{y}_{(2h)}(x + 2h) - \tilde{y}_{(h)}(x + 2h) }{2^s - 1}.
$$
Таким образом, если выполняется
$$
 \frac{\left|\tilde{y}_{(2h)} - \tilde{y}_{(h)} \right|}{2^s - 1} \leqslant \varepsilon,
$$
%------------------------------------------------------------------------------------------
то и точное решение $y$ уклоняется от приближенного $\tilde{y}_{(h)}$ не более, чем на
величину~$\varepsilon$.

Практически из последнего неравенства следует, что при отсутствии возможности
сравнения приближенных и точных решений, при вычислениях для достижения заданной
точности~$\varepsilon$ можно использовать
\emph{Метод двойного пересчета} (\emph{правило Рунге}): по формулам
Эйлера~\eqref{shema_Euler} или
Рунге "--- Кутты \eqref{runge_kutta_4} на каждой итерации находится при заданном изначально
шаге $h$ приближенное решение $\tilde{y}_{(h)}$ и значение $\tilde{y}_{(h/2)}$, определяемое по
тем же формулам при половинном шаге; если не выполняется неравенство
%------------------------------------------------------------------------------------------
\begin{equation} \label{Runge_rule}
 \frac{\left|\tilde{y}_{(h)} - \tilde{y}_{(h/2)} \right|}{2^s - 1} \leqslant \varepsilon,
\end{equation}
%------------------------------------------------------------------------------------------
где $s$ "--- порядок точности метода ($s = 1$ для схемы Эйлера и $s = 4$ для метода
Рунге "--- Кутты четвертого порядка),
то шаг снова следует уменьшить вдвое и проверить истинность оценки~\eqref{Runge_rule} для
полученных приближений.

Однако, следует помнить, что при измельчении шага начиная с некоторого значения $h$, точность
вычислений начинает  падать вследствии накапливания ошибок округления.
Поэтому в общем случае, как правило, приходится применять \emph{адаптивное изменение шага:}
<<простые>> части траектории (небольшая и плавно меняющаяся правая часть) следует проходить
с достаточно большим шагом (минимизируя ошибки округления), а на <<сложных>> участках
(большая и резко меняющаяся правая часть) шаг нужно уменьшать для достижения нужной локальной
точности.

\subsection{Исследование систем дифференциальных уравнений} \label{diff_issled}

В практических приложениях дифференциальные уравнения как правило описывают некоторую
математическую модель.
После построения математической модели проводится ее аналитическое или численное исследование,
позволяющее <<проиграть>> поведение моделируемого объекта при различных входных
параметрах.

\emph{Математическая модель} динамической системы включает задание
 параметров  и эволюционный оператор, позволяющий указать
 значения этих параметров во времени:
 $\mathbf{x} = \{x_1, x_2, \ldots, x_n\}$~--- набор чисел,
 описывающий состояние системы в момент времени $t$, эволюционный
 оператор определяется через скорость изменения (т.\,е. производную по времени) каждого
 параметра системы
 %%----------------------------------------------------------------------------
 \begin{equation}\label{dinam_syst}
 \dfrac{d x_i}{dt} = F_i (x_1, x_2, \ldots, x_n), \quad i =
 1, \ldots, n.
 \end{equation}
 %%----------------------------------------------------------------------------
 Точка $\mathbf{x}$ множества \, $\mathbb{R}^n$ принадлежит т.\,н.
 \emph{фазовому пространству} системы \eqref{dinam_syst}. Дополнив \eqref{dinam_syst}
 начальными условиями
 $\mathbf{x} = \mathbf{x_0}$ получим \emph{задачу Коши}, решение
 которой образует \emph{фазовую траекторию}. Множества фазовых траекторий,
 отвечающих различным начальным условиям, образуют \emph{фазовый
 портрет} системы.

 Если не известно аналитическое решение дифференциального уравнения, численные решения
получают последовательно задавая значения входных параметров "--- начальных или
краевых условий, констант и т.\,д. "--- \emph{вычислительный эксперимент.}
Если дифференциальные уравнения \eqref{dinam_syst} нелинейны, то
 \emph{аналитическое} решение этой системы, как правило, вызывает большие трудности и,
 чаще всего, невозможно.

 К тому же, часто бывают нужны данные о поведении модели при
\emph{всех} входных параметрах, а не при их ограниченном иножестве.

Фазовые траектории дают наглядное представление
 о поведении динамической системы. Их вид часто можно определить не
 прибегая к решению, на основе качественного анализа системы.

 Рассмотрим пример. \emph{Математический маятник} представляет собой
 материальную точку, которая под действием силы тяжести движется по
 дуге окружности радиуса $l$, лежащей в вертикальной плоскости. Материальная точка массы
 $m$ в начальный момент времени $t = 0$ получает угловую скорость $v_0$ и находится под действием
 только лишь силы тяжести (пренебрегаем трением и прочими факторами), направленной вертикально
 вниз.
 Таким образом, в
 соответствии со II-м законом Ньютона,
 уравнение движения маятника задаётся соотношением
 $$%%----------------------------------------------------------------------------
  ml \ddot{\varphi} = -mg \sin \varphi,
 $$%%----------------------------------------------------------------------------
где $\varphi$~--- угол отклонения материальной точки от вертикали, $g$~--- ускорение свободного
падения,
откуда, учитывая начальные условия, получим
 %%----------------------------------------------------------------------------
 \begin{equation} \label{mayat_1}
    l \ddot{\varphi} = -g \sin \varphi, \qquad
   \varphi(0) = 0,  \quad \dot{\varphi}(0) = v_0.
 \end{equation}
 %%----------------------------------------------------------------------------
Если, для того чтобы привести уравнение \eqref{mayat_1} в
соответствие с \eqref{dinam_syst}, положим $x_1 = \varphi$, $x_2 =
\dot{\varphi}$, то получим задачу Коши для нелинейной системы двух дифференциальных
уравнений
 %%--------------------------------------------------------------------
 \begin{align}
   & \dot{x}_1 = x_2, \label{pendulum_01} \\
   & \dot{x}_2 = -\frac{g}{l}\, \sin x_1 \label{pendulum_02} \\
   &  x_1(0)  = 0, \\
   &  x_2(0) = v_0
 \end{align}
%%--------------------------------------------------------------------

Динамические системы, в которых полная энергия сохраняется (как в
рассмотренном примере) называются \emph{консервативными}.

Полученная фазовая кривая (использовано численное решение) имеет
следующий вид

%%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\begin{figure}[!h]
 \centering
 \animategraphics[ controls, loop,
                   scale      = 1.0,
                   width      = 1.0\textwidth,
                   %height     = 0.36\textheight,
                   depth      = 1.0em,
                   buttonsize = 1.0em
                 ]
                 {200} {"animate/portret_pend_1"} {} {}
\vspace{0.5ex}
\caption{Маятник без трения}
\end{figure}
%%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Замкнутые фазовые кривые отвечают
тем начальным значениям, при которых происходят колебания маятника,
тем более близкие к \emph{гармоническим}, чем ближе форма этих
кривых к окружностям. Система совершает гармонические колебания при
малых углах $\varphi$, тогда в уравнении \eqref{mayat_1} можно принять $\sin
\varphi \approx \varphi$.

В реальных физических системах обычно происходят потери энергии
(например, за счёт трения).
Чтобы учесть трение в нашей модели, считая, что сила трения
пропорциональна скорости $\dot{\varphi}$ движения маятника,
преобразуем уравнение \eqref{mayat_1} к виду
%%----------------------------------------------------------------------------
 \begin{equation} \label{mayat_2}
    l \ddot{\varphi} = -g \sin \varphi -a \dot{\varphi}, \qquad
   \varphi(0) = 0,  \quad \dot{\varphi}(0) = v_0,
 \end{equation}
%%----------------------------------------------------------------------------
где $a$~--- константа. Фазовая траектория системы теперь будет такой
%%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\begin{figure}[!h]
 \centering
 \animategraphics[ controls, loop,
                   scale      = 1.0,
                   width      = 1.0\textwidth,
                   %height     = 0.42\textheight,
                   depth      = 1.0em,
                   buttonsize = 1.0em
                 ]
                 {200} {"animate/portret_pend_2"} {} {}
\vspace{0.5ex}
\caption{Маятник c трением}
\end{figure}
%%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

В консервативных системах не существует \emph{притягивающих
множеств} (\emph{аттракторов}, от англ. attract~--- притягивать,
привлекать), т.\,е.~таких подмножеств фазового пространства, к
которым с течением времени стремятся траектории, начинающиеся в
некоторой их окрестности. В диссипативных же системах они могут
существовать. В примере с затухающими колебаниями аттрактор состоит
из единственной точки~--- начала координат.
 В более общем случае потери энергии динамической
системой из-за трения или, например, вязкости всегда приводят к
тому, что орбиты притягиваются к некоторому подмножеству
фазового пространства. Грубо говоря, аттрактор отвечает
\emph{установившемуся} поведению системы~--- тому, к которому она
<<стремится>>.

В частности, известны т.\,н. \emph{странные аттрактор} "--- аттракторы, траектория которых
не замыкается и режим функционирования неустойчив (малые отклонения от режима нарастают).
Динамика странных аттракторов часто бывает хаотической: предсказание траектории, попавшей в
аттрактор, затруднено, поскольку малая погрешность в начальных параметрах через некоторое время
может привести к сильному расхождению прогноза с реальной траекторией. Непредсказуемость
траектории в \emph{детерминированных} динамических системах называют \emph{динамическим хаосом}
(эффектом бабочки) \cite{GLEICK}.



























%$$
% \gr{qwertyuiop ; asdfghjkl ; zxcvbnm}
%$$























 \ifflagNOBOOK
 \end{document}
 \fi
